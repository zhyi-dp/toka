// tests/pass/test_string_v13.tk
import std/io::println
import std/memory::assert
import std/string::String

fn main() -> i32 {
    println("Testing String v1.3...")

    // 1. Basic Construction
    auto s = String::from("Hello")
    println("Initial string: {}", s.c_str())
    println("Length: {} (expected 5)", s.len())
    println("Capacity: {} (expected 6)", s.capacity())

    assert(s.len() == 5, "Initial length mismatch")

    // 2. Growth via push_str
    s.push_str(" Toka")
    println("Modified string: {}", s.c_str())
    println("New Length: {} (expected 10)", s.len())
    
    assert(s.len() == 10, "Modified length mismatch")

    // 3. Repeated growth to trigger realloc
    s.push_str("! This is a long string to trigger realloc.")
    println("Final string: {}", s.c_str())
    println("Final Length: {}", s.len())
    println("Final Capacity: {}", s.capacity())

    assert(s.len() > 10, "Final length check failed")

    // 4. Memory Cleanup
    s.drop()
    println("String dropped successfully.")

    return 0
}

// Copyright (c) 2025 YiZhonghua<zhyi@dpai.com>. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// tests/pass/test_string_v13.tk
import std/io::println
import std/debug::assert
import std/string::String

fn main() -> i32 {
    println("Testing String v1.3...")

    // 1. Basic Construction
    auto s = String::from("Hello")
    println("Initial string: {}", s.c_str())
    println("Length: {} (expected 5)", s.len())
    println("Capacity: {} (expected 6)", s.capacity())

    assert(s.len() == 5, "Initial length mismatch")

    // 2. Growth via push_str
    s.push_str(" Toka")
    println("Modified string: {}", s.c_str())
    println("New Length: {} (expected 10)", s.len())
    
    assert(s.len() == 10, "Modified length mismatch")

    // 3. Repeated growth to trigger realloc
    s.push_str("! This is a long string to trigger realloc.")
    println("Final string: {}", s.c_str())
    println("Final Length: {}", s.len())
    println("Final Capacity: {}", s.capacity())

    assert(s.len() > 10, "Final length check failed")

    return 0
}

import std/io::*
import std/string::{String}

fn main() -> i32 {
    auto path = String::from("test_io_ext.tmp")
    auto new_path = String::from("test_io_ext_renamed.tmp")
    
    // 1. Test stdout
    print(String::from("Testing stdout print...\n"))
    
    // 2. Test exists (should be false)
    if exists(path) {
        print(String::from("Error: file should not exist yet\n"))
        return 1
    }
    
    // 3. Create file and test write/flush/seek/tell
    auto f = File::open(path, String::from("w+"))
    if !f.opened {
        print(String::from("Error: failed to create test file\n"))
        return 2
    }
    
    f.write(String::from("ABCDEF"))
    f.flush()
    
    auto pos = f.tell()
    if pos != 6:i64 {
        print(String::from("Error: tell() expected 6\n"))
        return 3
    }
    
    f.seek(0:i64, 0:i32) // SEEK_SET
    auto pos2 = f.tell()
    if pos2 != 0:i64 {
        print(String::from("Error: tell() expected 0 after seek\n"))
        return 4
    }
    
    f.close()
    
    // 4. Test exists (should be true)
    if !exists(path) {
        print(String::from("Error: file should exist now\n"))
        return 5
    }
    
    // 5. Test rename
    if !rename_file(path, new_path) {
        print(String::from("Error: rename failed\n"))
        return 6
    }
    
    if exists(path) {
        print(String::from("Error: old path should not exist after rename\n"))
        return 7
    }
    
    if !exists(new_path) {
        print(String::from("Error: new path should exist after rename\n"))
        return 8
    }
    
    // 6. Test remove
    if !remove_file(new_path) {
        print(String::from("Error: remove failed\n"))
        return 9
    }
    
    if exists(new_path) {
        print(String::from("Error: file should not exist after remove\n"))
        return 10
    }
    
    print(String::from("I/O extension test passed!\n"))
    return 0
}

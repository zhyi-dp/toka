// Copyright (c) 2025 YiZhonghua<zhyi@dpai.com>. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// include/toka/DiagnosticDefs.def

// --- Sema: Scope & Identifiers ---
DIAG(ERR_VAR_REDECLARED,     Error, "E0401", "Variable '{}' is already declared in this scope")
DIAG(ERR_UNDECLARED,         Error, "E0402", "Use of undeclared identifier '{}'")
DIAG(ERR_MODULE_NOT_FOUND,   Error, "E0403", "Module '{}' not found")
DIAG(ERR_SYMBOL_NOT_FOUND,   Error, "E0404", "Symbol '{}' not found in module '{}'")
DIAG(ERR_PRIVATE_TYPE,       Error, "E0405", "Shape '{}' is private and cannot be accessed from module '{}'")
DIAG(ERR_UNDEFINED_TYPE,     Error, "E0405", "Type '{}' is undefined")
DIAG(NOTE_GENERIC_IMPL_HINT, Note,  "N0003", "If '{}' is intended to be a generic parameter, declare it in the impl: 'impl<{}> {} ...'")

DIAG(ERR_GENERIC_SEMA,       Error, "E0406", "{}")
DIAG(ERR_OPERAND_TYPE_MISMATCH, Error, "E0407", "Operand of '{}' must be {}, got '{}'")
DIAG(NOTE_GENERIC,           Note,  "N0001", "{}")

// --- Sema: Type Checking & Operations ---
DIAG(ERR_TYPE_MISMATCH,      Error, "E0408", "Cannot convert type '{}' to '{}'")
DIAG(ERR_INIT_TYPE_MISMATCH, Error, "E0409", "Cannot initialize variable of type '{}' with value of type '{}'")
DIAG(ERR_USE_UNSET,          Error, "E0410", "Use of unset variable or member '{}'")
DIAG(ERR_ESCAPE_UNSET,       Error, "E0411", "Cannot escape an unset or dirty variable '{}'")
DIAG(ERR_DIRTY_REF_ESCAPE,   Error, "E0412", "Reference '{}' to unset variable '{}' escapes scope without initialization")
DIAG(ERR_INVALID_OP,         Error, "E0413", "Invalid operands for operation '{}': '{}' and '{}'")
DIAG(ERR_TYPE_REQUIRED,      Error, "E0414", "Type annotation required for variable '{}'")
DIAG(ERR_INFER_NULLPTR,      Error, "E0415", "Cannot infer type from 'nullptr'; explicit type annotation required (e.g., 'auto *p: Type = ...')")

// --- Sema: Shape & Structs ---
DIAG(ERR_UNKNOWN_STRUCT,     Error, "E0416", "Unknown shape type '{}'")
DIAG(ERR_NO_SUCH_MEMBER,     Error, "E0417", "Shape '{}' has no member named '{}'")
DIAG(ERR_MEMBER_PRIVATE,     Error, "E0418", "Member '{}' of shape '{}' is private")
DIAG(ERR_MEMBER_NOT_FOUND,   Error, "E0419", "Member '{}' not found on type '{}'")
DIAG(ERR_TUPLE_INDEX_OOB,    Error, "E0420", "Tuple index '{}' out of range (size {})")
DIAG(ERR_NOT_A_STRUCT,       Error, "E0421", "Member access '{}' on non-shape type '{}'")
DIAG(ERR_MEMBER_TYPE_MISMATCH, Error, "E0422", "Type mismatch for member '{}': expected '{}', but got '{}'")
DIAG(ERR_MISSING_MEMBER,     Error, "E0423", "Missing initialization for member '{}' of shape '{}'")
DIAG(ERR_DUPLICATE_FIELD,    Error, "E0424", "Duplicate field '{}' in shape initialization")
DIAG(ERR_UNION_PARTIAL_INIT, Error, "E0425", "Partial initialization of Union '{}': variant '{}' size {} is smaller than Union size {}")
DIAG(ERR_UNION_INVALID_MEMBER, Error, "E0426", "Union member '{}' has restricted type '{}' (underlying '{}')")
DIAG(ERR_UNION_RESOURCE_TYPE, Error, "E0427", "Union member '{}' has type '{}' which manages resources (HasDrop); unions must be data-only")
DIAG(NOTE_UNION_RESOURCE_TIP, Note,  "N0002", "Unions cannot track active variants to drop resources safely; consider using a raw pointer '*{}' or 'ManuallyDrop<T>'")

// --- Sema: Traits & Interfaces ---
DIAG(ERR_SIGNATURE_MISMATCH, Error, "E0428", "Method signature mismatch: trait defines '{}' as {}, but implementation is {}")
DIAG(ERR_MISSING_IMPL,       Error, "E0429", "Trait '{}' requires implementation of method '{}'")
DIAG(ERR_TRAIT_NOT_FOUND,    Error, "E0430", "Trait '{}' is not implemented for type '{}'")

// --- Sema: Control Flow & Functions ---
DIAG(ERR_CONTROL_REACHES_END, Error, "E0431", "Control flow reaches end of non-void function '{}'")
DIAG(ERR_YIELD_VALUE_REQUIRED, Error, "E0432", "Yielding {} must pass a value")
DIAG(ERR_YIELD_ELSE_REQUIRED,  Error, "E0433", "Yielding if expression must have an 'else' block")
DIAG(ERR_YIELD_OR_REQUIRED,    Error, "E0434", "Yielding {} loop must have an 'or' block")
DIAG(ERR_BRANCH_TYPE_MISMATCH, Error, "E0435", "{} branches have incompatible types: '{}' vs '{}'")
DIAG(ERR_PASS_NO_RECEIVER,    Error, "E0436", "'pass' used without a receiver; prefix the expression with 'auto x =' or 'alias y ='")
DIAG(ERR_METHOD_PRIVATE,      Error, "E0437", "Method '{}' is private to '{}' and cannot be accessed from module '{}'")

// --- Sema: Ownership & Resources (Toka Specials) ---
DIAG(ERR_USE_MOVED,          Error, "E0438", "Use of moved value: '{}'")
DIAG(ERR_MOVE_MEMBER_DROP,   Error, "E0439", "Cannot move member '{}' out of shape '{}' because it implements 'drop'")
DIAG(ERR_MOVE_BORROWED,      Error, "E0440", "Cannot move '{}' while it is borrowed")
DIAG(ERR_BORROW_MUT,         Error, "E0441", "Cannot access '{}' while it is mutably borrowed")
DIAG(ERR_BORROW_IMMUT,       Error, "E0442", "Cannot mutably borrow immutable entity '{}'")
DIAG(ERR_IMMUTABLE_MOD,      Error, "E0443", "Cannot modify immutable entity '{}'")
DIAG(ERR_SHAPE_NO_DROP,      Error, "E0444", "Shape '{}' manages resources but does not implement 'drop'")
DIAG(ERR_UNSAFE_RAW_PTR,     Error, "E0445", "Shape '{}' manages raw pointers but does not implement 'drop'")
DIAG(ERR_UNSAFE_RESOURCE,    Error, "E0446", "Shape '{}' contains managed resources but does not implement 'drop'")
DIAG(ERR_NULL_ACCESS,        Error, "E0447", "Accessing member of nullable type '{}' requires explicit 'is' check")
DIAG(ERR_MORPHOLOGY_MISMATCH, Error, "E0448", "Pointer morphology mismatch: expected explicit '{}' (from LHS/Target), found '{}' (from RHS/Source)")
DIAG(ERR_SMART_PTR_FROM_STACK, Error, "E0449", "Smart pointer sigil '{}' cannot be applied to stack variable; use 'new' or assign from existing smart pointer")
DIAG(ERR_CAST_MISMATCH,       Error, "E0450", "Invalid cast: cannot convert '{}' to '{}' via 'as'; only 'Addr' and '*' conversions are supported")
DIAG(ERR_POINTER_SIGIL_MISSING, Error, "E0451", "Variable '{}' implies pointer type '{}' but lacks explicit sigil. Use 'auto {}{}' or dereference.")
DIAG(ERR_MEMBER_SIGIL_MISMATCH, Error, "E0452", "Dot operator '.' cannot be used with explicit pointer sigil. Did you mean '^ptr->member' or 'ptr.member'?")
DIAG(ERR_ARROW_SIGIL_REQUIRED,  Error, "E0453", "Arrow operator '->' requires explicit pointer sigil on variable. Did you mean '^ptr->member'?")
DIAG(ERR_LIFETIME_UNION_REQUIRED, Error, "E0454", "Returning reference to parameter '{}' requires explicit dependency declaration (<- {})")
DIAG(ERR_ESCAPE_LOCAL,           Error, "E0455", "Returning reference to local variable '{}' is unsafe")
DIAG(ERR_BORROW_LIFETIME,        Error, "E0456", "Object '{}' (lived longer) cannot depend on '{}' (lived shorter)")
DIAG(ERR_LIFETIME_UNION_VIOLATION, Error, "E0457", "Lifetime union violation: '{}' does not live long enough")
DIAG(ERR_REDUNDANT_BLOCK,        Error, "E0460", "Redundant inherent restriction '$' on '{}'; it is already immutable by default")

// --- Sema: Memory Safety ---
DIAG(ERR_UNSAFE_ALLOC_CTX,   Error, "E0501", "Operation 'alloc' is only allowed in unsafe context")
DIAG(ERR_FREE_SMART,         Error, "E0502", "Manual 'free' forbidden for smart pointer '{}'; memory is managed automatically")
DIAG(ERR_FREE_NON_PTR,       Error, "E0503", "Cannot 'free' value of type '{}'; expected raw pointer")

// --- Pattern Matching ---
DIAG(ERR_VARIANT_NO_PAYLOAD, Error, "E0550", "Enum variant '{}' does not accept arguments")
DIAG(ERR_VARIANT_ARG_MISMATCH, Error, "E0551", "Enum variant '{}' expects {} fields, but got {}")
DIAG(ERR_UNKNOWN_SHAPE_IN_PAT, Error, "E0552", "Unknown type '{}' in pattern matching")

// --- Generics (Upcoming) ---
DIAG(ERR_GENERIC_COUNT_MISMATCH, Error, "E0601", "Type '{}' expects {} generic arguments, but got {}")
DIAG(ERR_GENERIC_ARITY_MISMATCH, Error, "E0602", "Generic mismatch for '{}': expected {} arguments, got {}")
DIAG(ERR_GENERIC_RECURSION_LIMIT, Error, "E0603", "Generic instantiation recursion limit reached for '{}'")
DIAG(ERR_GENERIC_CODEGEN,    Error, "E0604", "Generic instantiation failed: {}")
DIAG(ERR_CODEGEN,            Error, "E0701", "Code generation failed: {}")
DIAG(ERR_CONST_GENERIC_NAMING, Error, "E0605", "Const generic parameter '{}' must end with '_' (e.g., 'N_') to denote compile-time constant.")

// --- Parser Errors ---
DIAG(ERR_EXPECTED_SEMI,      Error, "E0101", "Expected ';' or newline after statement")
DIAG(ERR_EXPECTED_DECL,      Error, "E0102", "Expected declaration after 'pub' modifier")
DIAG(ERR_EXTERN_PUB,         Error, "E0103", "'extern' blocks cannot be declared 'pub'")
DIAG(ERR_IMPL_PUB,           Error, "E0104", "'impl' blocks cannot be declared 'pub'")
DIAG(ERR_GENERIC_PARSE,      Error, "E0105", "Parse error: {}")

// --- Warnings ---
DIAG(WARN_CODEGEN_UNRESOLVED, Warning, "W0001", "Unresolved member type for '{}'; defaulting to i32")

// --- System & CLI ---
DIAG(ERR_FILE_IO,            Error, "E0901", "File I/O Error: {}")
DIAG(ERR_CLI_ARG,            Error, "E0902", "Invalid command line argument: {}")
